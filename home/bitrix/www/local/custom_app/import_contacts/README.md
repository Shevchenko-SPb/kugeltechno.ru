# Импорт контактов

Модуль для импорта контактов из Excel файлов в CRM Битрикс24.

## Структура файлов

- `index.php` - Главная страница с формой загрузки файлов
- `upload.php` - Обработчик загруженных файлов
- `process.php` - Процессор импорта контактов
- `Settings.php` - Настройки и конфигурация полей
- `lib/` - Библиотеки
  - `UploadContacts.php` - Основной класс для импорта контактов
  - `SimpleXLSX.php` - Библиотека для работы с XLSX файлами
  - `AuthController.php` - Контроллер авторизации

## Формат Excel файла

### Текущая структура (8 столбцов):

1. **Контрагент** - Название компании
2. **ИНН** - ИНН компании (обязательное поле)
3. **Страна** - Страна компании
4. **КонтактноеЛицо** - ФИО контактного лица
5. **Должность** - Должность контактного лица
6. **Телефон** - Рабочий телефон
7. **Мобильный телефон** - Мобильный телефон
8. **Email** - Электронная почта

### Изменения в структуре

**Обновлено:** Структура полей была изменена с 12 столбцов на 8 столбцов:

**Старая структура (12 столбцов):**
1. Контрагент
2. ИНН
3. (пустой столбец)
4. Фамилия
5. Имя
6. Отчество
7. Должность
8. Телефон
9. (пустой столбец)
10. (пустой столбец)
11. Мобильный телефон
12. Email

**Новая структура (8 столбцов):**
1. Контрагент
2. ИНН
3. Страна
4. КонтактноеЛицо
5. Должность
6. Телефон
7. Мобильный телефон
8. Email

### Гибкость названий столбцов

Система поддерживает различные варианты названий столбцов:

- **КонтактноеЛицо**: ФИО, Контакт, Лицо, Представитель, Полное имя
- **Страна**: Country, Государство, Регион
- **Мобильный телефон**: Мобильный, Сотовый, Моб
- **Должность**: Позиция, Роль, ДолжностьПоВизитке
- **Email**: Почта, Mail, Электронная почта

## Использование

1. Откройте `index.php` в браузере
2. Выберите Excel файл (.xlsx) с контактами в правильном формате
3. Нажмите кнопку "Импортировать"
4. Система проверит структуру файла и покажет предупреждения при несоответствии
5. Файл будет обработан пакетами по 10 контактов

## Требования

- PHP с поддержкой ZipArchive
- SimpleXML
- FileInfo
- Битрикс24 CRM модуль
- Права на создание/редактирование контактов и компаний